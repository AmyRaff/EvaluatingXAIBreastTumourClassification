Evaluating Explainable AI Techniques for Breast Tumour Classification
-
This repository contains the supporting code for this report. 

Code Overview
-
Supporting Python files and their purposes are as follows:

- helper.py - Contains helper functions for loading and splititng the data.
- model_creation.py - Creates, trains and saves an instance of the CNN. I also include saved model (.h5) files for models generated with 25, 50, 75 and 100 epochs in this directory.
- get_model_outputs.py - Evaluates model performance by calculating the accuracy and F1 Score, and generating a confusion matrix.
- LIME_explainer.py - Generates a LIME explanation. Optionally shows and saves the explanation.
- RISE_explainer.py - Generates a RISE explanation. Optionally shows and saves the explanation.
- SHAP_explainer.py - Generates a SHAP explanation. Optionally shows and saves the explanation.

The main file for this experiment is main.py, which runs each explainer for all images in a dataset (validation or testing), saves the explanations if applicable, generates pixel agreement statistics, and generates results for the RBO and Kendall's Tau experiments.

In terms of statistical analysis, this file outputs two text files:

- out.txt - Contains pixel agreement statistics for each pairwise comparison, and a 3-way comparison, for all images in the dataset.
- rbo_vals.txt - Contains RBO and Kendall's Tau statistics for each image in the dataset.

These text files are raw data. The Python files necessary to process this data are as follows:

- generate_proportions_data.py - Converts out.txt to useable statistics which can be found in proportions_data.csv. This file is used to generate pixel agreement statistics such as averages, using Excel.
- one_way_anova.py - Contains the One-Way ANOVA experiment. Outputs p-values, the statistical composition of the pixel agreement lists, and a boxplot for use in the report.
- generate_rbo_kendall.py - Contains the RBO and Kendall's Tau experiments. Converts rbo_vals.txt to useable statistics which can be found in rbo_data.csv and kendall_data.csv. These files are used to generate the statistics regarding RBO values and the Kendall's Tau statistical test, using Excel.

The empirical experiment to determine how many LIME features to use in my final explanations was completed by running main.py with differing feature values. The pixel agreement statistics gained from this can be found in empirical_L_experiment.csv. 
The average pixel agreement from each comparison was calculated by Excel for each L. These values, and the code for generating the plot in the report, can be found in empirical_plot.py.

This code is my own work except where stated otherwise in the comments of this code. In these areas, I have linked the public github repositories which were used.
Some inspiration was taken from Python APIs and public community code, however tweaks were necessary for the code to function with my CNN and with image data.

Other Files
-

The raw results I received from the radiologist can be found in expert_opinion.xlsx.

The explanations directory contains individual explanations for each image in the test set, as generated by LIME, RISE and SHAP. Note that re-running main.py with image saving toggled will not re-write these images - these are used in the report.

The figs directory contains other figures generated by my code, including confusion matrices, box plots and the overlay plots used to showcase the agreement between the top n most important pixels for each tehcnique.

I have not included the dataset used, as it is public and linked to in my report.

